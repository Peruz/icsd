
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/run_landfill3d.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_run_landfill3d.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_run_landfill3d.py:


Inversion of current source density apply to a roots imaging
------------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 5-66



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_run_landfill3d_001.png
          :alt: run landfill3d
          :srcset: /auto_examples/images/sphx_glr_run_landfill3d_001.png
          :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_run_landfill3d_002.png
          :alt: run landfill3d
          :srcset: /auto_examples/images/sphx_glr_run_landfill3d_002.png
          :class: sphx-glr-multi-img

.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_run_landfill3d_003.png
         :alt: Obs T=0
         :srcset: /auto_examples/images/sphx_glr_run_landfill3d_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_run_landfill3d_004.png
         :alt: run landfill3d
         :srcset: /auto_examples/images/sphx_glr_run_landfill3d_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_run_landfill3d_005.png
         :alt: run landfill3d
         :srcset: /auto_examples/images/sphx_glr_run_landfill3d_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_run_landfill3d_006.png
         :alt: Scattered current sources density, wr=1
         :srcset: /auto_examples/images/sphx_glr_run_landfill3d_006.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    no existing survey
    initiation ICSD
    log transformation: False
    obs_err: sqrt
    errRmin not correctly set, adjust
    False
    ./Landfill_3d/
    run_single i=0
    UNconstrainsted inversion
    ********************
    CURRENT Sum=1.0000000004516265
    index = 0
    interpolation spacing=3.55
    wr = 1
    x0_prior = False
    run_single i=0
    UNconstrainsted inversion
    ********************
    CURRENT Sum=1.0000000004516265
    run_single i=0
    UNconstrainsted inversion
    ********************
    CURRENT Sum=1.0000000004516265
    regMesh = strc
    wr = 1
    x0_prior = False
    run_single i=0
    UNconstrainsted inversion
    ********************
    CURRENT Sum=1.0000000004516265
    /home/ben/Documents/GitHub/icsd/examples/run_landfill3d.py:55: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
      ax=fig.gca(projection='3d')
    interpolation spacing=3.55






|

.. code-block:: default

    import os
    import matplotlib.pyplot as plt

    # -----------------------------------#
    # Exemple Landfill
    # -----------------------------------#
    path2files="./Landfill_3d/"

    from icsd.icsd3d import iCSD3d as i3d 
    from icsd.plotters import mpl_plot
    import numpy as np


    coords_elecs = np.loadtxt(path2files+'coords_elecs.txt')[:-3,:]
    len(coords_elecs)
    mpl_plot.showObs2d(path2files,coords_elecs,
                       filename='solution.data')

    icsd3d_landfill=i3d(dirName=path2files)   
    icsd3d_landfill.regMesh='strc'
    icsd3d_landfill.type='3d'
    icsd3d_landfill.obs_err='sqrt' # choose between constant weight and w = 1/sqrt(abs(obs))
    icsd3d_landfill.wr=1 #weight regularization
    icsd3d_landfill.alphaSxy=False
    icsd3d_landfill.x0_prior=False
    icsd3d_landfill.x0_ini_guess=False # initial guess

    
    icsd3d_landfill.createSurvey(fname_obs='solution.data',fname_sim='Green.data')

    icsd3d_landfill.invert(show=True)

    # Unconstrainsted current source densities inversion
    icsd3d_landfill.invert(wr=1,x0_prior=False)

    icsd3d_landfill.invert()
    # Estimate initial model
    icsd3d_landfill.estimateM0(method_m0='F1', show=True)

    # Constrainsted current source densities inversion
    icsd3d_landfill.invert(regMesh='strc',wr=1,x0_prior=False)
    # icsd3d_landfill.invertregMesh='strc',x0_prior=True)


    import matplotlib.pyplot as plt

    from mpl_toolkits.mplot3d import Axes3D


    fig = plt.figure()
    ax=fig.gca(projection='3d')
    icsd3d_landfill.showResults(ax=ax,
                                mesh='fwd_mesh_landfill.vtk')
    plt.show()









.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  8.288 seconds)


.. _sphx_glr_download_auto_examples_run_landfill3d.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: run_landfill3d.py <run_landfill3d.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: run_landfill3d.ipynb <run_landfill3d.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
