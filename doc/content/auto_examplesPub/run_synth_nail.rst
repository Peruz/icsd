
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "content/auto_examplesPub/run_synth_nail.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_content_auto_examplesPub_run_synth_nail.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_content_auto_examplesPub_run_synth_nail.py:


Multiple sources inversion of CSD
-----------------------------------
The procedure to generate the data is describe in Peruzzo et al. (2020). 
The synthetic test evaluates the iCSD capability to locate a current point source (white dot). 
The white circles represent the VRTe and the white square the return electrode. 
The source of current was centered between four VRTe to highlight the distribution of the current density.

*Peruzzo, L., Chou, C., Wu, Y. et al. Imaging of plant current pathways for non-invasive root Phenotyping using a newly developed electrical current source density approach. Plant Soil 450, 567â€“584 (2020). https://doi.org/10.1007/s11104-020-04529-w*

.. GENERATED FROM PYTHON SOURCE LINES 15-16

**Import the icsd package**

.. GENERATED FROM PYTHON SOURCE LINES 16-19

.. code-block:: default

    import matplotlib.pyplot as plt
    from icsd.icsd3d import iCSD3d as i3d 








.. GENERATED FROM PYTHON SOURCE LINES 20-21

**Change inversion parameters** 

.. GENERATED FROM PYTHON SOURCE LINES 21-39

.. code-block:: default

    path2files="./iCSD_fig7/"
    icsd=i3d(dirName=path2files)   

    from icsd.icsd3d import iCSD3d as i3d 

    icsd=i3d(dirName=path2files)   
    icsd.type='2d'
    icsd.obs_err='sqrt' # choose between constant weight and w = 1/sqrt(abs(obs))
    icsd.wr=1 #weight regularization
    icsd.alphaSxy=False
    icsd.x0_prior=False
    icsd.x0_ini_guess=False # initial guess

    icsd.createSurvey(fname_obs='ObsData.txt',fname_sim='VRTeSim.txt')
    sol= icsd.invert(x0_prior=False,wr=1,show=True)






.. image-sg:: /content/auto_examplesPub/images/sphx_glr_run_synth_nail_001.png
   :alt: CSD 2d T0  $\lambda$=1
   :srcset: /content/auto_examplesPub/images/sphx_glr_run_synth_nail_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    no existing survey
    initiation ICSD
    log transformation: False
    obs_err: sqrt
    True
    ./iCSD_fig7/
    x0_prior = False
    wr = 1
    run_single i=0
    UNconstrainsted inversion
    ********************
    CURRENT Sum=1.0000000641016324





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.654 seconds)


.. _sphx_glr_download_content_auto_examplesPub_run_synth_nail.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: run_synth_nail.py <run_synth_nail.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: run_synth_nail.ipynb <run_synth_nail.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
