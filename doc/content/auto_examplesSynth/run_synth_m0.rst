
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "content/auto_examplesSynth/run_synth_m0.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_content_auto_examplesSynth_run_synth_m0.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_content_auto_examplesSynth_run_synth_m0.py:


Single source Estimation of CSD
--------------------------------
The procedure to generate the data is describe in Peruzzo et al. (2020). 
The synthetic test evaluates the iCSD capability to locate a current point source (white dot). 
The white circles represent the VRTe and the white square the return electrode. 
The source of current was centered between four VRTe to highlight the distribution of the current density.

Here we compared the estimation using the F1 method and the Pearson method.

.. math::

    r_{k}= rac{\sum_{i}(D_{I}-\overline{D})(F_{i}(I_{k})-\overline{F}(I_{k}))}{\sqrt{\sum_{i}(D_{I}-\overline{D})^{2}}\sum_{i}(F_{i}(I_{k})-\overline{F}(I_{k}))^{2}}
where $D_{i}$ is the $i^{th}$ measured transfer resistance and $F_{i}(I_{k})$ is the $i^{th}$  transfer resistance computed to unit current at location k.

*Peruzzo, L., Chou, C., Wu, Y. et al. Imaging of plant current pathways for non-invasive root Phenotyping using a newly developed electrical current source density approach. Plant Soil 450, 567â€“584 (2020). https://doi.org/10.1007/s11104-020-04529-w*

.. GENERATED FROM PYTHON SOURCE LINES 22-23

**Import the icsd package**

.. GENERATED FROM PYTHON SOURCE LINES 23-26

.. code-block:: default

    import matplotlib.pyplot as plt
    from icsd.icsd3d import iCSD3d as i3d 








.. GENERATED FROM PYTHON SOURCE LINES 27-29

**Change inversion parameters** 
The default dimension type is 2d

.. GENERATED FROM PYTHON SOURCE LINES 29-35

.. code-block:: default

    path2files="./iCSD_fig7/"
    icsd=i3d(dirName=path2files)   

    icsd.createSurvey(fname_obs='ObsData.txt',fname_sim='VRTeSim.txt')
    m0 = icsd.estimateM0(methodM0='F1',show=True)




.. image-sg:: /content/auto_examplesSynth/images/sphx_glr_run_synth_m0_001.png
   :alt: Estimated m0  T0
   :srcset: /content/auto_examplesSynth/images/sphx_glr_run_synth_m0_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    no existing survey
    initiation ICSD
    log transformation: False
    obs_err: sqrt
    True
    ./iCSD_fig7/




.. GENERATED FROM PYTHON SOURCE LINES 36-38

**Change inversion parameters** 
Change the estimate to Pearson

.. GENERATED FROM PYTHON SOURCE LINES 38-47

.. code-block:: default


    m0 = icsd.estimateM0(methodM0='Pearson',show=False)

    fig, ax = plt.subplots(1)
    icsd.showEstimateM0(ax=ax)







.. image-sg:: /content/auto_examplesSynth/images/sphx_glr_run_synth_m0_002.png
   :alt: Estimated m0  T0
   :srcset: /content/auto_examplesSynth/images/sphx_glr_run_synth_m0_002.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.605 seconds)


.. _sphx_glr_download_content_auto_examplesSynth_run_synth_m0.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: run_synth_m0.py <run_synth_m0.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: run_synth_m0.ipynb <run_synth_m0.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
